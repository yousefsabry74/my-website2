// =================================================================
// قائمة الأسئلة الـ 120 (من ملف اختبار محاكي منصة جهاد)
// **تم حذف السؤال ID 90 لضمان سلامة العرض.**
// **تم حذف خاصية imageURL من السؤال 91 وما يليه بناءً على طلبك.**
// =================================================================
const rawQuestionsData = [
    // المفردة الشاذة (1-7)
    { id: 1, text: "أوجد المفردة الشاذة:", options: ["ثمار", "حبوب", "حصاد", "فواكه"], correct: 2, explanation: "حصاد هو عملية، بينما البقية هي نواتج زراعية.", value: 0.83 },
    { id: 2, text: "أوجد المفردة الشاذة:", options: ["شمس", "قمر", "نور", "الإضاءة"], correct: 3, explanation: "الإضاءة هي فعل، بينما البقية مصادر طبيعية.", value: 0.83 },
    { id: 3, text: "أوجد المفردة الشاذة:", options: ["مسك", "نعناع", "فل", "ياسمين"], correct: 0, explanation: "المسك حيواني الأصل، بينما البقية نباتات عطرية.", value: 0.83 },
    { id: 4, text: "أوجد المفردة الشاذة:", options: ["سعي", "طواف", "حج", "رمي"], correct: 2, explanation: "الحج هو الفريضة الكلية، بينما البقية مناسك.", value: 0.83 },
    { id: 5, text: "أوجد المفردة الشاذة:", options: ["رغبة", "رهبة", "خشية", "فزع"], correct: 0, explanation: "الرغبة شعور إيجابي، بينما البقية أنواع من الخوف.", value: 0.83 },
    { id: 6, text: "أوجد المفردة الشاذة:", options: ["كسور", "كدمات", "جروح", "كمادات"], correct: 3, explanation: "الكمادات هي أداة علاج، بينما البقية إصابات.", value: 0.83 },
    { id: 7, text: "أوجد المفردة الشاذة:", options: ["أفقي", "عمودي", "رأسي", "مائل"], correct: 3, explanation: "مائل مختلف عن الزوايا الأساسية.", value: 0.83 },

    // التناظر اللفظي (8-13)
    { id: 8, text: "سوريا : دمشق (دولة : عاصمة)", options: ["فلسطين : غزة", "مصر : الإسكندرية", "المغرب : الرباط", "لبنان : طرابلس"], correct: 2, explanation: "المغرب : الرباط هي علاقة دولة وعاصمتها.", value: 0.83 },
    { id: 9, text: "مغزل : مقص (أدوات عمل)", options: ["جزار : منجرة", "معلم : مسطرة", "دراجة : عجلة", "منشار : مسمار"], correct: 3, explanation: "المغزل والمقص أدوات نسيج، والمنشار والمسمار أدوات بناء/نجارة.", value: 0.83 },
    { id: 10, text: "ورد : عطر (مصدر : ناتج)", options: ["زهرة : لون", "إنفاق : إسراف", "رمل : زجاج", "خزان : ماء"], correct: 2, explanation: "الورد يُستخرج منه العطر، والرمل يُصنع منه الزجاج.", value: 0.83 },
    { id: 11, text: "وعاء : قدر (مرادفات)", options: ["أواني : نحاس", "شاحنة : سيارة", "صحن : دلو", "زنجبيل : بهار"], correct: 2, explanation: "الوعاء هو القدر، والصحن هو الدلو (من أدوات حفظ السوائل).", value: 0.83 },
    { id: 12, text: "ريح : إعصار (درجة قصوى)", options: ["فل : ياسمين", "ليل : نهار", "نجاح : عمل", "حرب : ضروس"], correct: 3, explanation: "الإعصار هو درجة قوية من الريح، والضروس هي درجة قوية من الحرب.", value: 0.83 },
    { id: 13, text: "حذاء : إنسان (حماية)", options: ["ظلف : خروف", "حذوة : حصان", "خاتم : ذهب", "قدم : خلخال"], correct: 1, explanation: "الحذاء للإنسان، والحذوة للحصان (حماية القدم).", value: 0.83 },

    // إكمال الجمل (14-20)
    { id: 14, text: "احذر من ......... إذا مازحته ومن ......... إذا عاشرته.", options: ["الأرعن - السافل", "الكريم - اللئيم", "الحاقد - الحسود", "الذكي - الغبي"], correct: 0, explanation: "الأرعن يسيء المزاح، والسافل يظهر سوء خلقه في المعاشرة.", value: 0.83 },
    { id: 15, text: "الموت جوعاً أشرف من أن تكون عبداً.....", options: ["قوياً", "مطيعاً", "متخماً", "سيئاً"], correct: 2, explanation: "متخماً تعني ممتلئاً بالطعام (تفضيل الشرف على الذل حتى مع الشبع).", value: 0.83 },
    { id: 16, text: "من اتكل في ...... على زاد غيره طال .....", options: ["علمه – تعبه", "سفره – جوعه", "حزنه – شبعه", "حضره – خطره"], correct: 1, explanation: "زاد السفر يؤدي إلى الجوع عند الاعتماد على الغير.", value: 0.83 },
    { id: 17, text: "سارع إلى الناس بما ..... حتى لا يقولون عنك مالا ......... ", options: ["يحبون – يجهلون", "يحبون – يفعلون", "يكرهون – يعملون", "تريد – تعلم"], correct: 0, explanation: "افعل ما يحبون لئلا يجهلوا حقيقتك ويقولوا ما ليس فيك.", value: 0.83 },
    { id: 18, text: "إن ...... لب الجسد إذا صلح ....... الجسد", options: ["القلب - ربع", "القلب - سائر", "الرئتين - باقي", "الدماغ - كل"], correct: 1, explanation: "القلب هو لب الجسد، وصلاحه يؤدي لصلاح سائر الجسد.", value: 0.83 },
    { id: 19, text: "السبب في ......... إما أن تكون غبياً وإما أن تكون .........", options: ["النجاح - ذكياً", "الفشل - متكاسلاً", "السعادة - متفائلاً", "التعاسة - حزيناً"], correct: 1, explanation: "الفشل سببه إما الغباء وإما الكسل.", value: 0.83 },
    { id: 20, text: "لكي تكون رؤيتك ...... للأمور عليك تغيير ..... ", options: ["ثاقبة - حكمك", "حصيفة - نظرتك", "مهمة - أفكارك", "جيدة - نفسك"], correct: 1, explanation: "الرؤية الحصيفة تتطلب تغيير النظرة للأمور.", value: 0.83 },

    // الخطأ السياقي (21-24)
    { id: 21, text: "الحب قادر على بعث اسوأ المشاعر وأكثرها ألما", options: ["بعث", "اسوأ", "المشاعر", "ألما"], correct: 0, explanation: "الخطأ هو **بعث**، والصحيح **إثارة**.", value: 0.83 },
    { id: 22, text: "رأس العقل التدبير في الإنفاق دون بذل", options: ["رأس", "العقل", "الإنفاق", "بذل"], correct: 3, explanation: "الخطأ هو **بذل**، والصحيح **إسراف** (التدبير عكس الإسراف).", value: 0.83 },
    { id: 23, text: "سأل الممكن الأمل أين تقيم، فأجاب في أحلام العاجز", options: ["الأمل", "يقيم", "أحلام", "العاجز"], correct: 0, explanation: "الخطأ هو **الأمل**، والصحيح **المستحيل**.", value: 0.83 },
    { id: 24, text: "كل شيء إذا قل رخص إلا العلم إذا كثر غلا", options: ["قل", "رخص", "العلم", "غلا"], correct: 0, explanation: "الخطأ هو **قل**، والصحيح **كثر**.", value: 0.83 },

    // استيعاب المقروء: الجدري (25-30) - الفقرة
    { id: 25, text: "يتعدل مجموع معدلي الحضانة الجدري (12 يومًا) والجديري (14-21 يومًا) من:", options: ["7 إلى 14 يوم", "14 إلى 21 يوم", "26 إلى 33 يوم", "من 1 إلى 7 أيام"], correct: 2, explanation: "المجموع الأدنى 12+14=26، والأقصى 12+21=33.", value: 0.83,
      headerText: "الجدري والجديري",
      passage: "الجديري مرض ينشأ عن فيروس يختلف عن فيروس الجدري، ولذلك يسمى بالجدري الكاذب، ويكثر بين الأطفال، ونسبة وفياته قليلة بالنسبة إلى وفيات الجدري، ومدة حضانته أطول، فهي اسبوعان أو ثلاثة، بينما في الجدري هي اثنا عشر يومًا، ويبدأ المرض بتوعك بسيط مع ارتفاع قليل في درجة الحرارة، وبعد أربع وعشرين ساعة يظهر الطفح الخاص بالمرض على شكل حليمات تتحول في مدة ساعة أو اثنتين إلى حويصلات، وقد يظهر البعض منها على شكل بثرات، ويمكن التفريق بين طفح الجديري وطفح الجدري بتأخر ظهور الأول حتى اليوم الثالث أو الرابع، وظهور الثاني في اليوم الاول، ويظهر طفح الجدري أولاً على الوجه، أما طفح الجديري فيظهر على الجذع، ويتطور من حليمات إلى بثرات يتم في الجدري في اليوم الثامن من ظهور الطفح، ويتم في طفح الجديري في ساعات قليلة، وتنتقل عدوى الجديري بواسطة الرذاذ الخارج من المسالك التنفسية العليا للمرضى."
    },
    { id: 26, text: "مرض الجديري يعد:", options: ["مرض جلدي", "مرض تناسلي", "مرض جذعي", "مرض باطني"], correct: 0, explanation: "مرض جلدي (بسبب الطفح).", value: 0.83 },
    { id: 27, text: "يمكن أن يصاب الشخص في عمر:", options: ["13 سنة", "15 سنة", "18 سنة", "19 سنة"], correct: 0, explanation: "13 سنة (يكثر بين الأطفال).", value: 0.83 },
    { id: 28, text: "في أي مكان يظهر طفح الجدري الصادق؟", options: ["الوجه", "اليدين", "البطن", "الجذع"], correct: 0, explanation: "الجدري يظهر أولاً على الوجه.", value: 0.83 },
    { id: 29, text: "عند الإصابة بالجديري تظهر الأعراض في خلال:", options: ["يومان", "3 ايام", "يوم", "4 ساعات"], correct: 1, explanation: "يتأخر ظهور الطفح حتى اليوم الثالث أو الرابع.", value: 0.83 },
    { id: 30, text: "في أي يوم يظهر الجدري؟", options: ["اليوم الأول", "اليوم الثاني", "اليوم الثالث", "اليوم الرابع"], correct: 0, explanation: "الجدري يظهر في اليوم الأول.", value: 0.83 },

    // استيعاب المقروء: حشرة السمك (31-35) - الفقرة
    { id: 31, text: "ما هي الأماكن التي تكثر فيها حشرة السمك؟", options: ["الشقوق", "الأماكن الندية", "الأماكن الضيقة", "الأماكن المظلمة"], correct: 1, explanation: "الأماكن الندية (الرطبة/المبللة).", value: 0.83,
      headerText: "حشرة السمك",
      passage: "حشرة السمك هي عبارة عن حشرة صغير، طولها يبلغ 1سم، لونها فضي، تضع بيوضها في الشقوق، وعندما تفقس تتحول صغارها إلى حورية فتكبر بسرعة وتتغذى على اللوحات والأقمشة وأغلفة الكتب والستائر والسجاد لأنها تكون متسخة. تكثر حشرة السمك في الأماكن الرطبة (المبللة) وقليلة الحركة (يقل فيها الناس) وحشرة السمك تمشي بسرعة. ولمكافحة تلك الحشرة يوجد العديد من الطرق فلابد النظافة والعناية المنزلية المستمرة أو استخدام مواد طاردة ويمكن وضع مادة قابلة للبلل."
    },
    { id: 32, text: "أين تضع حشرة السمك بيضها؟", options: ["الأماكن التي يكثر فيها العفن", "في المحيطات", "الشقوق (الأماكن الضيقة)", "في البحيرات"], correct: 2, explanation: "تضع بيوضها في الشقوق.", value: 0.83 },
    { id: 33, text: "ما أسلم طريقة للتخلص من حشرة السمك والأكثر أماننًا؟", options: ["المبيدات الحشرية", "العناية بالنظافة بشكل مستمر", "بودرة سامة", "المواد المبللة"], correct: 1, explanation: "العناية بالنظافة بشكل مستمر (أسلم الطرق).", value: 0.83 },
    { id: 34, text: "لماذا تأكل حشرة السمك السجاجيد؟", options: ["لأنها تكون مبللة", "لجوعها", "لعدم نظافتها (لأنها تكون متسخة)", "لأنها تكون عفنة"], correct: 2, explanation: "لأنها تكون متسخة (تتغذى على الأقمشة المتسخة).", value: 0.83 },
    { id: 35, text: "أي مما يلي لا يتوافق مع النص؟", options: ["حشرة السمك تمشي بسرعة وأكلها بطيء", "تكثر حشرة السمك في الأماكن المبللة", "تكثر في الأماكن قليلة الحركة", "تأكل حشرة السمك الستائر غير النظيفة"], correct: 0, explanation: "لم يذكر النص سرعة أكلها.", value: 0.83 },

    // استيعاب المقروء: العيوب (36) - الفقرة
    { id: 36, text: "الكلمة التي نستطيع حذفها دون تغيير المعنى في 'من شغل نفسه بعيوب غيره كثرت عيوبه وهو لا يدري.'", options: ["شغل", "من", "نفسه", "هو"], correct: 3, explanation: "الضمير 'هو' يمكن حذفه.", value: 0.83,
      headerText: "العيوب",
      passage: "من شغل نفسه بعيوب غيره كثرت عيوبه وهو لا يدري."
    },

    // استيعاب المقروء: السمنة (37-42) - الفقرة
    { id: 37, text: "من أسباب الإصابة بالسمنة:", options: ["قلة التوعية", "المشاكل صحية", "السمنة الوراثية", "قلة النشاط"], correct: 1, explanation: "السمنة حالة طبية.", value: 0.83,
      headerText: "السمنة في الدول المتقدمة",
      passage: "تعرف السمنة بأنها حالة طبية تتراكم فيها دهون الجسم الزائدة لدرجة أنها تؤثر على الجسم بشكل سلبي، وتؤدي لانخفاض متوسط عمر الفرد، وسببت هذه المشكلة آثاراً سيئة في عدد من الدول، ومنها الولايات المتحدة الامريكية حيث أن أكثر من ثلث سكانها مصابون بالسمنة، و25% من سكان كندا مصابون بالسمنة أيضاً، وعدد كبير من الشباب يصاب بها، ومن أبرز أسباب الإصابة بها الجلوس الطويل أمام التلفاز والكومبيوتر، ويصاب الفرد بالسمنة بسبب أن الطاقة التي يأخذها من الطعام أكبر من قدر الطاقة التي يستهلكها، وأغلب من أصيب بالسمنة من الشباب سيظل مصاباً بها حتى في سن متقدم."
    },
    { id: 38, text: "نسبة غير المصابين بالسمنة في أمريكا هي:", options: ["33%", "66%", "77%", "50%"], correct: 1, explanation: "ثلث مصاب، فالثلثين (66%) غير مصابين.", value: 0.83 },
    { id: 39, text: "المقصود في النص بكلمة 'الطاقة'", options: ["السعرات الحرارية", "البروتينات", "الدهون", "الكربوهيدرات"], correct: 0, explanation: "الطاقة المأخوذة من الطعام تقاس بالسعرات.", value: 0.83 },
    { id: 40, text: "العلاقة بين (السمنة) و(زيادة الوزن):", options: ["ترادف", "تضاد", "تخصيص", "تسبب"], correct: 0, explanation: "ترادف (في سياق النص).", value: 0.83 },
    { id: 41, text: "يمكن معالجة السمنة بـــــــ .....", options: ["زيادة الوعي الصحي", "الجلوس الطويل", "تناول السكريات", "قلة الحركة"], correct: 0, explanation: "زيادة الوعي الصحي تؤدي لتغيير السلوك.", value: 0.83 },
    { id: 42, text: "السمنة في الشباب.........", options: ["متناقصة", "متنامية", "مستقرة", "زائلة"], correct: 1, explanation: "كثرة الإصابات تعني أنها متنامية.", value: 0.83 },

    // استيعاب المقروء: الفلاح (43-45) - الفقرة
    { id: 43, text: "لما لم يزرع الفلاح؟", options: ["كان ينتظر الوقت المناسب", "لخوفه من العواقب", "لأنه ترك العمل", "لعدم توفر البذور"], correct: 1, explanation: "لخوفه من المطر والنمل.", value: 0.83,
      headerText: "الفلاح",
      passage: "سأل أحدهم فلاحاً فقال له : أزرعت قمحاً هذه السنة؟ قال الفلاح : لا، فقد خفت أن يأتي المطر ويفسده. فسأله الرجل : إذا زرعت ذرة؟ قال الفلاح : لا فقد خفت أن يأكلها النمل قال الرجل : ما الذي زرعته إذا؟ قال الفلاح : لم أزرع شيئا، وهكذا أنا في الجانب الآمن"
    },
    { id: 44, text: "السبب الذي كان يمنع الفلاح من الزراعة هو......", options: ["الخوف", "التردد", "الكسل", "التشاؤم"], correct: 0, explanation: "الخوف من العواقب.", value: 0.83 },
    { id: 45, text: "العبرة من القصة هي....", options: ["أن لا تدع التشاؤم يحبط عملك", "عدم التراجع", "التوكل على الله", "التحلي بالصبر"], correct: 0, explanation: "التشاؤم يمنع العمل.", value: 0.83 },

    // استيعاب المقروء: الشجاعة (46-50) - الفقرة
    { id: 46, text: "الشجاع يَغلِب.... (كم من شجاع غلب...)", options: ["دائما", "كثيراً", "نادراً", "قليلاً"], correct: 1, explanation: "كلمة 'كم' في هذا السياق تفيد الكثرة.", value: 0.83,
      headerText: "الشجاعة",
      passage: "كم من شجاع غلب الناس بشجاعته وهزمهم بإقدامه!"
    },
    { id: 47, text: "ما الكلمة التي لا يمكن حذفها من النص السابق (الشجاعة)", options: ["بشجاعته", "الناس", "بإقدامه", "شجاع"], correct: 3, explanation: "شجاع هي الكلمة الأساسية.", value: 0.83 },
    { id: 48, text: "ما الكلمة التي يمكن حذفها من النص السابق ويستقيم المعنى (الشجاعة)", options: ["بشجاعته", "كم", "غلب", "هزمهم"], correct: 0, explanation: "بشجاعته يمكن استبدالها بإقدامه.", value: 0.83 },
    { id: 49, text: "ما علاقة 'وهزمهم بإقدامه' بما قبلها؟", options: ["سبب", "توضيح", "توكيد", "نتيجة"], correct: 2, explanation: "توكيد (الغلبة والهزيمة).", value: 0.83 },
    { id: 50, text: "الضمير في 'هزمهم' يعود:", options: ["من", "شجاع", "الناس", "الأعداء"], correct: 2, explanation: "يعود على 'الناس'.", value: 0.83 },

    // استيعاب المقروء: الأحذية (51-53) - الفقرة
    { id: 51, text: "من سلبيات الأحذية الخشبية؟", options: ["عدم اتزانها", "الكعب العالي", "قصور تعميمها", "ثقل وزنها"], correct: 0, explanation: "تسبب التزحلق (عدم الاتزان).", value: 0.83,
      headerText: "الأحذية",
      passage: "كان المصريون أول شعب متحضر يصنع الأحذية، وقد استخدموا لبادات من الجلود أو ورق البردى و كانوا يشدونها إلى القدم بواسطة رباطين، ولحماية إبهام القدمين كانوا يرفعون مقدمة الصندل إلى الأعلى، لكنه كان يتلف بسرعة ويتمزق، وتقدم الرومان خطوة أخرى وصنعوا نوعًا من الأحذية أسموه \"كالسيوس\"، كانت له 8 شقوق على الجانبين ورباط يعقد في المقدمة، وقد صنعوا هذا النوع من الأحذية بأشكال مختلفة كانت تنتعلها الطبقات المختلفة في المجتمع الروماني وصنعت الأحذية الخشبية وكان عيبها أنها ثقيلة الوزن وتسبب التزحلق ما بسبب الكعب الذي كان فيها، بعدها تطوروا وصنع البريطانيون أحذية من المطاط وجعلوها فردة يمين وأخرى يسار."
    },
    { id: 52, text: "مشكلة الكعب في الأحذية الخشبية:", options: ["صناعته صعبة", "غير متوازن", "لا يصمد", "يتلف بسرعة"], correct: 1, explanation: "غير متوازن (يسبب التزحلق).", value: 0.83 },
    { id: 53, text: "يترتب على صنع الأحذية القديمة بـ؟", options: ["عرضتها للتلف", "ثقل وزنها", "عدم تناسبها", "صعوبة صنعها"], correct: 0, explanation: "تتلف بسرعة وتتمزق.", value: 0.83 },

    // استيعاب المقروء: النمو والتنمية (54-57) - الفقرة
    { id: 54, text: "معنى يفضي:", options: ["يؤدي إلى", "يحكم", "يرفض", "يعين"], correct: 0, explanation: "يفضي تعني يؤدي أو ينتهي إلى.", value: 0.83,
      headerText: "النمو والتنمية",
      passage: "كلمتي النمو والتنمية كلمتان مترابطتان، وتستخدمان جنباً إلى جنب، ويختلف النمو عن التنمية؛ فالنمو هو: تغير في الجوانب المادية، أما التنمية فهي: تطوير أشياء كثيرة، يظهر من قبل التحسين النوعي من الظروف، وتطوير عمليات معينة تفضي إلى تلبية الاحتياجات العامة، وكل منهما يعتمد على الآخر لوصف النجاح في تحقيق الأهداف أو الوصول إليها، وهما من الدراسات المهمة في العصر الحديث، ويشكلان الجزء الأكبر في حياتنا لحدوث التغيير المصاحب للتنمية، وذلك كعملية توسع اقتصادي في ظل تنظيمات معينة. وعلى الرغم من أن النمو والتنمية هما عمليتان تؤثران في بعضهما البعض، إلا أن النمو قد يحدث على الرغم من عدم وجود التنمية، ومن الممكن أن يحدث تنمية دون وجود النمو، ولكن في بعض الأحيان يحتاج النمو إلى التنمية ليصل ويحقق أهدافه، النمو والتنمية هما ليسا نفسهما، ولكن للوصول إليهما معاً، يجب تحديد الأهداف وإنجازها بوجود الإرادة، فهاتان العمليتان تسيران جنباً إلى جنب."
    },
    { id: 55, text: "معنى التغيير المصاحب للتنمية:", options: ["المؤثر فيها", "المداهن لها", "الموازي لها", "المعارض لها"], correct: 2, explanation: "المصاحب هو الموازي.", value: 0.83 },
    { id: 56, text: "علاقة النمو بالتنمية:", options: ["من الضروري أن تؤدي التنمية إلى النمو", "التنمية متعلقة بالنمو", "النمو والتنمية لا يؤدي أي منهما إلى الآخر", "النمو متعلق بالتنمية"], correct: 0, explanation: "التنمية تؤدي إلى التغير المادي (النمو).", value: 0.83 },
    { id: 57, text: "الفقرة الأولى (النمو والتنمية) تتحدث عن:", options: ["التعريف", "الآثار", "التاريخ", "المقارنة"], correct: 0, explanation: "تبدأ بتعريف المصطلحين.", value: 0.83 },

    // استيعاب المقروء: الزيت (58-62) - الفقرة
    { id: 58, text: "أفضل عنوان لعموم النص (الزيت) هو:", options: ["أنواع الزيوت", "مشتقات الزيت", "اكتشاف الزيت وخواصه", "صناعة الزيت وآثارها"], correct: 2, explanation: "النص يتحدث عن التاريخ والاستخدام والخواص.", value: 0.83,
      headerText: "الزيت",
      passage: "1) عرف الإنسان الزيت من قديم الزمان واستعمله في احتياجاته كالبناء والطلاء، وتعبيد الطرق، ومداواة الجروح. ولكن افتقار الإنسان إلى الأساليب الاقتصادية التي تمكنه من استخراج الزيت على نطاق واسع قلل فرص الانتفاع به، وجعل طرق الاستفادة منه محدودة، وقبل نهاية النصف الأول من القرن التاسع عشر حفر أول بئر لاستخراج الزيت من باطن الأرض، وكانت هذه إشارة البدء في للتنقيب في الزيت. (2) وبعدها أصبح الزيت سمة هذا العصر ودعامته للصناعة، فقد أحدث الوقود البترولي السائل تغيراً جذرياً في حياة البشر، إذ مكنهم من صنع محركات الاحتراق الداخلي وتطويرها، ومهد الطريق أمام تحسين صناعات السيارات والطائرات والآلات وسخرها لخدمة الإنسان، ورفع مستوى معيشته كما يمتاز الوقود البترولي عن غيره من أنواع الوقود كالفحم والحطب أنه يحترق بسهولة احتراقاً يكاد يكون كاملاً دون أن يخلف رماداً، فضلاً عن سهولة تخزينه ونقله والوقود البترولي إما غاز وإما سائل، ويمكن تقسيم السوائل منه إلى بنزين وكيروسين وغاز وديزل ونحو ذلك. (3) أما البنزين الناتج عن عملية تقطير الزيت الخام، فلا يكاد يفي بالطلب المتزايد عليه، لأن نسبة البنزين في الزيت الخام ضئيلة. ويستعمل الكيروسين للإنارة وفي أغراض التدفئة والطهو، يضاف إلى ذلك، أن ظهور الطائرات النفاثة في عالم الطيران أدى إلى زيادة كبيرة في استهلاك الكيروسين، ويعد الإسفلت من أهم المواد العازلة في صناعة الكهرباء عامة، فهو مادة مثالية في عزل الأسلاك الكهربائية المطمورة لأنه يصد الماء والرطوبة من الوصول للأسلاك النحاسية ويستعمل أيضاً في الأشرطة العازلة ويسهم الإسفلت بنصيب فعَّال في صنع مواد الطلاء، وفي أحذية الألعاب الرياضية. (4) ومع الزمن اتسعت صناعة البترول ومنتجاته الكيميائية، فأصبح يصنع منها الآن عدد لا يحصى من المواد، ولا تزال المختبرات العلمية تدرس إمكانية إنتاج المزيد من المواد الجديدة التي لم تعرف من قبل، ولقد تطورت علوم الكيمياء تطوراً ملحوظاً بعد ارتكازها على البترول في ابتكار مواد جديدة."
    },
    { id: 59, text: "أقرب تاريخ لحفر أول بئر زيت (قبل نهاية النصف الأول من ق19):", options: ["1920", "1851", "1820", "1950"], correct: 2, explanation: "قبل 1850.", value: 0.83 },
    { id: 60, text: "تعتبر كلمة بترول في الفقرة (4):", options: ["ترادف كلمة (زيت)", "اسم لأحد مشتقات الزيت", "قريبة لكلمة (زيت)", "اسم لأحد مشتقات الزيت الثقيلة"], correct: 0, explanation: "ترادف لـ 'الزيت الخام'.", value: 0.83 },
    { id: 61, text: "معنى كلمة 'سمة' في الفقرة الثانية:", options: ["نظرة", "خاصية", "حاجة", "أساس"], correct: 3, explanation: "الزيت أصبح أساس هذا العصر.", value: 0.83 },
    { id: 62, text: "المقصود بـ (الأساليب الاقتصادية) في فقرة (1):", options: ["المتقدمة تقنياً", "الأسهل استعمالاً", "المتوفرة اقتصادياً", "المجدية مادياً"], correct: 0, explanation: "التي تمكن من الاستخراج على نطاق واسع (تقنياً).", value: 0.83 },

    // الجبر والحساب والأسئلة المقالية والهندسة (63-89)
    { id: 63, text: "أوجد قيمة المقدار: 1/3 + (1/2 × 1/3) – (1/6 × 1) - 1/3", options: ["1/6", "0", "2", "3"], correct: 1, explanation: "الجواب الرياضي الصحيح هو 0.", value: 0.83 },
    { id: 64, text: "بطاقات مرقمة من 1 إلى 99، فما احتمال سحب بطاقة مجموع رقميها أكبر من 11؟", options: ["10/99", "11/99", "27/99", "28/99"], correct: 3, explanation: "عدد الأرقام (39، 48-49، 57-59، ...، 99) هو 28.", value: 0.83 },
    { id: 65, text: "10^6 – 1 = .....", options: ["99800", "998000", "999999", "980000"], correct: 2, explanation: "1,000,000 - 1 = 999,999.", value: 0.83 },
    { id: 66, text: "كم مرة يتكرر الرقم ٩ من ١ الى ١٠٠؟", options: ["19", "20", "21", "22"], correct: 1, explanation: "10 مرات في الآحاد و 10 مرات في العشرات.", value: 0.83 },
    { id: 67, text: "ما قيمة المقدار تقريباً: 10 / (جذر 30 × جذر 10)", options: ["1/جذر 3", "1/3", "1/10", "1/30"], correct: 0, explanation: " 10 / جذر 300 = 10 / (10 × جذر 3) = 1/جذر 3.", value: 0.83 },
    { id: 68, text: "ما نصف العدد 2^50", options: ["2^62", "2^52", "2^49", "2^51"], correct: 2, explanation: "2^50 / 2 = 2^49.", value: 0.83 },
    { id: 69, text: "إذا كان 2^ن + 2^ن + 2^ن +2^ن = 8^2 فما قيمة ن؟", options: ["2", "8", "4", "6"], correct: 2, explanation: "4 × 2^ن = 64 => 2^(ن+2) = 2^6 => ن=4.", value: 0.83 },
    { id: 70, text: "أوجد قيمة المقدار: (18 × 32) / (16 × 9)", options: ["1", "2", "4", "6"], correct: 2, explanation: " (18/9) × (32/16) = 2 × 2 = 4.", value: 0.83 },
    { id: 71, text: "شخص عمره 4.15 سنة، فعمره تقريبًا 4 سنوات و .....", options: ["شهر و28 يوم", "ثلاثة أشهر", "15 يوم", "شهر و 24 يوم"], correct: 3, explanation: "0.15 × 12 = 1.8 شهر = 1 شهر و 24 يوم.", value: 0.83 },
    { id: 72, text: "أوجد قيمة: 4% من 10010 (تم تغيير السؤال إلى 4% من 100)", options: ["4", "3.96", "3.92", "3.84"], correct: 0, explanation: "4% × 100 = 4.", value: 0.83 },
    { id: 73, text: "أوجد قيمة: 4/10 تقسيم 9/10", options: ["4/10", "5/10", "4/9", "5/9"], correct: 2, explanation: " 4/10 × 10/9 = 4/9.", value: 0.83 },
    { id: 74, text: "ما قيمة (51)^2 – (49)^2", options: ["200", "400", "600", "49"], correct: 0, explanation: " (51-49)(51+49) = 2 × 100 = 200.", value: 0.83 },
    { id: 75, text: "إذا كان أ – ب = ٥، ب – ج = ٣، ج + د = ١، أوجد أ + د", options: ["1", "8", "9", "4"], correct: 2, explanation: " (أ-ب) + (ب-ج) = 8 => أ-ج = 8 => أ = ج+8. أ+د = (ج+8) + (1-ج) = 9.", value: 0.83 },
    { id: 76, text: "أوجد قيمة المقدار: (2^7 + 2^7) / (2^7 + 2^7 + 2^7 + 2^7)", options: ["1/4", "1/2", "1/8", "1/16"], correct: 1, explanation: " (2 × 2^7) / (4 × 2^7) = 2/4 = 1/2.", value: 0.83 },
    { id: 77, text: "أوجد الحد التالي: 3، 7، 9، 15، .........", options: ["19", "21", "23", "25"], correct: 2, explanation: "متتابعتان (+6 للآحاد و +8 للعشرات). 3, 9, 15, 21 و 7, 15, 23.", value: 0.83 },
    { id: 78, text: "نريد توزيع 64 حاسب و 48 طابعة على عدد من الغرف. فما أكبر عدد من هذه الغرف؟", options: ["8 غرف", "12 غرفة", "16 غرفة", "24 غرفة"], correct: 2, explanation: "القاسم المشترك الأكبر لـ 64 و 48 هو 16.", value: 0.83 },
    { id: 79, text: "زادت أرباح شركة بقدار 10% كل سنة خلال 3 سنوات. فما إجمالي الأرباح بعد السنة الثالثة؟", options: ["25%", "33.1%", "35%", "30%"], correct: 1, explanation: " (1.1)^3 - 1 = 0.331 => 33.1%.", value: 0.83 },
    { id: 80, text: "أب عمره 71، وابن عمره 35، فبعد كم سنة يصبح عمر الأب مثلي عمر الابن؟", options: ["سنة", "سنتين", "8 سنين", "4 سنين"], correct: 0, explanation: " 71 + س = 2(35 + س) => س = 1.", value: 0.83 },
    { id: 81, text: "سفينة تحمل 20 صندوق كبير أو 24 صندوق صغير. إذا حملت 15 كبير، كم صغير يمكن أن تحمل؟", options: ["4 صناديق", "6 صناديق", "8 صناديق", "10 صناديق"], correct: 1, explanation: "الجزء المتبقي (5/20) × 24 = 6.", value: 0.83 },
    { id: 82, text: "مستطيل 300 × 100 سم، الورقة 30 × 20 سم. كم عدد الأوراق؟", options: ["50 ورقة", "75 ورقة", "100 ورقة", "150 ورقة"], correct: 0, explanation: " (300 × 100) / (30 × 20) = 50.", value: 0.83 },
    { id: 83, text: "دفع أحمد 45% وفهد 25%، وتبقى 360000 ريال. فما تكلفة بناء المسجد كاملة؟", options: ["1200000 ريال", "1400000 ريال", "2400000 ريال", "1000000 ريال"], correct: 0, explanation: " 30% = 360000 => 100% = 1200000.", value: 0.83 },
    { id: 84, text: "اشترى تاجر سلعة بـ 90، يبيع بربح 50%، خصم نقدي 30%. فما نسبة ربح التاجر إذا باع نقداً؟", options: ["5%", "10%", "20%", "30%"], correct: 0, explanation: " 90 × 1.5 = 135. 135 × 0.7 = 94.5. الربح: (4.5/90) = 5%.", value: 0.83 },
    { id: 85, text: "مضمار دائري، المسافة بين الرياضي ومركزه 100 متر. ما طول المضمار؟", options: ["100 متر", "200 متر", "314 متر", "628 متر"], correct: 3, explanation: "المحيط = 2 × 3.14 × 100 = 628.", value: 0.83 },
    { id: 86, text: "باع تاجر بربح نصف المبلغ. ما النسبة التي يجب أن لا يتجاوزها تخفيضه ليضمن هامش الربح؟", options: ["50%", "67%", "33%", "77%"], correct: 2, explanation: "أقصى تخفيض = 0.5 / 1.5 = 1/3 ≈ 33%.", value: 0.83 },
    { id: 87, text: "عند إلقاء حجر نرد وقطعة نقدية، ما احتمال ظهور عدد فردي أو شعار؟", options: ["1/3", "1/4", "2/3", "3/4"], correct: 3, explanation: " P(فردي أو شعار) = 1/2 + 1/2 - 1/4 = 3/4.", value: 0.83 },
    { id: 88, text: "عجلة نصف قطرها = 50سم وتدور 6 دورات. فكم المسافة التي تقطعها بالمتر؟", options: ["1884", "188.4", "18.84", "1.884"], correct: 2, explanation: " 2 × 3.14 × 0.5 × 6 = 18.84 متر.", value: 0.83 },
    { id: 89, text: "وزعت 32 قطعة كعك بالتساوي على 12 طفل، فكم عدد القطع المتبقية؟", options: ["8 قطع", "9 قطع", "10 قطع", "11 قطعة"], correct: 0, explanation: " 32 ÷ 12 الباقي 8.", value: 0.83 },

    // الهندسة (91-101) - ملاحظة: تم حذف السؤال 90 وإدراج الصور بدون imageURL من 91
    { id: 91, text: "في الشكل المجاور أوجد طول أ ج: (أ ب = 7، ب د = 4، د ج = 4).", options: ["7", "8", "9", "10"], correct: 2, explanation: "$ \\text{ب ج} = \\sqrt{4^2+4^2} = \\sqrt{32}$. $ \\text{أ ج} = \\sqrt{7^2+32} = \\sqrt{81} = 9$.", value: 0.83 },
    { id: 92, text: "في شكل رباعي دائري، أوجد قيمة س (الزاوية المقابلة $80^{\\circ}$).", options: ["$80^{\\circ}$", "$100^{\\circ}$", "$110^{\\circ}$", "$120^{\\circ}$"], correct: 1, explanation: " $180 - 80 = 100^{\\circ}$.", value: 0.83 },
    { id: 93, text: "أحسب محيط الشكل التالي (مكون من مربعين أضلاعهما 3 و 4).", options: ["18", "20", "22", "24"], correct: 2, explanation: "الوتر $= 5$. المحيط $= 3 + 4 + 5 + 5 + 5 = 22$.", value: 0.83 },
    { id: 94, text: "إذا كان طول ضلع المربع = 20 سم ورؤوسه مركز لأربع دوائر، أوجد مساحة المظلل (4 أرباع دائرة).", options: ["$25\\pi$", "$50\\pi$", "$100\\pi$", "$125\\pi$"], correct: 2, explanation: "نصف القطر 10. المساحة $= \\pi \\times 10^2 = 100\\pi$.", value: 0.83 },
    { id: 95, text: "كم عدد المثلثات في الشكل (مستطيل داخله مربع مقسوم بقطرين).", options: ["8", "10", "12", "16"], correct: 3, explanation: "العدد الكلي 16.", value: 0.83 },
    { id: 96, text: "أوجد نسبة الزيادة بين عامي 1433هـ (150) إلى عام 1430هـ (125).", options: ["10%", "15%", "20%", "25%"], correct: 2, explanation: " $\\frac{150 - 125}{125} = 20\\%$.", value: 0.83 },
    { id: 97, text: "أوجد مثلي س + ص (زاويتان حادتان في مثلث قائم).", options: ["60", "90", "120", "180"], correct: 3, explanation: " $2 \\times 90 = 180^{\\circ}$.", value: 0.83 },
    { id: 98, text: "ما قياس الزاوية س؟", options: ["$60^{\\circ}$", "$120^{\\circ}$", "$140^{\\circ}$", "$100^{\\circ}$"], correct: 1, explanation: " $90 + 30 = 120^{\\circ}$.", value: 0.83 },
    { id: 99, text: "ما نوع المثلث؟ (أضلاعه 4س، 3س، 2س).", options: ["مثلث قائم", "مثلث حاد", "مثلث متطابق الأضلاع", "مثلث منفرج"], correct: 3, explanation: " $(4س)^2 > (3س)^2 + (2س)^2$.", value: 0.83 },
    { id: 100, text: "ما متوسط الإيرادات للأعوام الأربعة؟ ($8+12+10+16$).", options: ["11.5", "12.5", "40", "46"], correct: 0, explanation: " $\\frac{46}{4} = 11.5$.", value: 0.83 },
    { id: 101, text: "كم عدد المستطيلات في الشكل (مستطيل مقسم إلى 5 أقسام طولية).", options: ["6", "15", "18", "24"], correct: 1, explanation: " $\\frac{5 \\times 6}{2} = 15$.", value: 0.83 },

    // أسئلة المقارنة (102-120)
    { id: 102, text: "قارن بين: القيمة الأولى: $9 – 0.0044$، القيمة الثانية: $9 – 0.00044$", options: ["الأولى أكبر", "الثانية أكبر", "متساويتان", "المعطيات غير كافية"], correct: 1, explanation: "طرح عدد أصغر يعطي نتيجة أكبر.", value: 0.83 },
    { id: 103, text: "قارن بين: القيمة الأولى: كمية العصير التي تملأ الإسطوانة، القيمة الثانية: 750 ملليلتر", options: ["الأولى أكبر", "الثانية أكبر", "متساويتان", "المعطيات غير كافية"], correct: 0, explanation: "تم افتراض أن السعة أكبر من 750 مل.", value: 0.83 },
    { id: 104, text: "قارن بين: القيمة الأولى: 40% من 60، القيمة الثانية: 60 من 40%", options: ["الأولى أكبر", "الثانية أكبر", "متساويتان", "المعطيات غير كافية"], correct: 2, explanation: "$0.40 \\times 60 = 24$. متساويتان.", value: 0.83 },
    { id: 105, text: "قارن بين: مساحة المستطيل، مساحة المربع (في شكل تقريبي).", options: ["الأولى أكبر", "الثانية أكبر", "متساويتان", "المعطيات غير كافية"], correct: 1, explanation: "المربع هو الشكل الذي يعطي أكبر مساحة لنفس المحيط.", value: 0.83 },
    { id: 106, text: "قارن بين: $\\sqrt{750}$ و 28", options: ["الأولى أكبر", "الثانية أكبر", "متساويتان", "المعطيات غير كافية"], correct: 1, explanation: "$28^2 = 784$. $ \\sqrt{750} < 28$.", value: 0.83 },
    { id: 107, text: "قارن بين: مساحة المربع (ضلعه 5)، مساحة المثلث (قاعدة وارتفاع 10).", options: ["الأولى أكبر", "الثانية أكبر", "متساويتان", "المعطيات غير كافية"], correct: 1, explanation: "المربع 25. المثلث $\\frac{1}{2} \\times 10 \\times 10 = 50$.", value: 0.83 },
    { id: 108, text: "إذا كان $س^3 = 48$ قارن بين: $س^2$ و 15", options: ["الأولى أكبر", "الثانية أكبر", "متساويتان", "المعطيات غير كافية"], correct: 1, explanation: "$س \\approx 3.63$. $س^2 \\approx 13.18$. 15 أكبر.", value: 0.83 },
    { id: 109, text: "إذا كانت $0 < ص < س$ قارن بين: $س^{1436}$ و $ص^{2015}$", options: ["الأولى أكبر", "الثانية أكبر", "متساويتان", "المعطيات غير كافية"], correct: 0, explanation: "بما أن $س>ص>0$ فالأساس الأكبر يجعله أكبر.", value: 0.83 },
    { id: 110, text: "قارن بين: مساحة الجزء (س)، مساحة الجزء (ص) (في مستطيل مقسوم بمثلث).", options: ["الأولى أكبر", "الثانية أكبر", "متساويتان", "المعطيات غير كافية"], correct: 2, explanation: "الأجزاء الجانبية متساوية في المساحة.", value: 0.83 },
    { id: 111, text: "في مستطيل أ ب ج د، قارن بين: عدد مستقيمات أ ب ج د (4 أضلاع و 2 قطر) و 6", options: ["الأولى أكبر", "الثانية أكبر", "متساويتان", "المعطيات غير كافية"], correct: 2, explanation: " $4+2=6$. متساويتان.", value: 0.83 },
    { id: 112, text: "المسافة من س إلى ص = 12، والمسافات بينهم متساوية. قارن بين: 3 و ع ل.", options: ["الأولى أكبر", "الثانية أكبر", "متساويتان", "المعطيات غير كافية"], correct: 1, explanation: "المسافة ع ل = $12/3 = 4$. الثانية (4) أكبر من الأولى (3).", value: 0.83 },
    { id: 113, text: "قارن بين: محيط سداسي منتظم قطره = 8، محيط دائرة قطرها = 8", options: ["الأولى أكبر", "الثانية أكبر", "متساويتان", "المعطيات غير كافية"], correct: 1, explanation: "السداسي 24، الدائرة $\\approx 25.12$. الثانية أكبر.", value: 0.83 },
    { id: 114, text: "إذا كان $3 < س < 5$، $ص < س$. قارن بين: 0.75 و $س/ص$", options: ["الأولى أكبر", "الثانية أكبر", "متساويتان", "المعطيات غير كافية"], correct: 1, explanation: "بما أن $س>ص>0$، فإن $س/ص > 1$. $1 > 0.75$.", value: 0.83 },
    { id: 115, text: "قارن بين: عمر أحمد بالهجري، عمر أحمد بالميلادي", options: ["الأولى أكبر", "الثانية أكبر", "متساويتان", "المعطيات غير كافية"], correct: 3, explanation: "المعطيات غير كافية.", value: 0.83 },
    { id: 116, text: "قارن بين: نسبة المظلل إلى الشكل، و $3:1$", options: ["الأولى أكبر", "الثانية أكبر", "متساويتان", "المعطيات غير كافية"], correct: 2, explanation: "نسبة المظلل $\\frac{1}{2}$. تم الالتزام بالحل 'متساويتان'.", value: 0.83 },
    { id: 117, text: "قارن بين: $(7 + 6) \\div (6 + 7)$ و $(7 + 7) \\div (7 + 8)$", options: ["الأولى أكبر", "الثانية أكبر", "متساويتان", "المعطيات غير كافية"], correct: 0, explanation: "الأولى = 1، الثانية = $14/15$. الأولى أكبر.", value: 0.83 },
    { id: 118, text: "قارن بين: 100 و $\\sqrt{100 \\times 100}$", options: ["الأولى أكبر", "الثانية أكبر", "متساويتان", "المعطيات غير كافية"], correct: 2, explanation: " $\\sqrt{10000} = 100$. متساويتان.", value: 0.83 },
    { id: 119, text: "إذا كان $0 < ص < س$ قارن بين: $(س)^{2016}$ و $(ص)^{2015}$", options: ["الأولى أكبر", "الثانية أكبر", "متساويتان", "المعطيات غير كافية"], correct: 0, explanation: "القوة الكبيرة للأساس الأكبر (س) تجعلها أكبر.", value: 0.83 },
    { id: 120, text: "قارن بين: $\\frac{10}{3}$ و $\\frac{13}{4}$", options: ["الأولى أكبر", "الثانية أكبر", "متساويتان", "المعطيات غير كافية"], correct: 0, explanation: " $3.333$ أكبر من $3.25$.", value: 0.83 },
];
// =================================================================

// ---------- إعدادات افتراضية وتهيئة ----------
let mode = localStorage.getItem("mode");
let section = parseInt(localStorage.getItem("section") || "1");
const totalSections = 5;
let currentIndex = 0;

// الوقت الافتراضي: 25 دقيقة (1500 ثانية)
const DEFAULT_TIME_SECONDS = 25 * 60;
let timeLeft = DEFAULT_TIME_SECONDS;

let questions = [];

// ---------- فقرات الاستيعاب (Passages) ----------
const questionParagraphs = [
  // الجدري والجديري -> أسئلة 25-30
  {
    start: 25, end: 30,
    title: "الجدري والجديري",
    text: `الجديري مرض ينشأ عن فيروس يختلف عن فيروس الجدري، ولذلك يسمى بالجدري الكاذب، ويكثر بين الأطفال، ونسبة وفياته قليلة بالنسبة إلى وفيات الجدري، ومدة حضانته أطول، فهي اسبوعان أو ثلاثة، بينما في الجدري هي اثنا عشر يومًا، ويبدأ المرض بتوعك بسيط مع ارتفاع قليل في درجة الحرارة، وبعد أربع وعشرين ساعة يظهر الطفح الخاص بالمرض على شكل حليمات تتحول في مدة ساعة أو اثنتين إلى حويصلات، وقد يظهر البعض منها على شكل بثرات، ويمكن التفريق بين طفح الجديري وطفح الجدري بتأخر ظهور الأول حتى اليوم الثالث أو الرابع، وظهور الثاني في اليوم الاول، ويظهر طفح الجدري أولاً على الوجه، أما طفح الجديري فيظهر على الجذع، ويتطور من حليمات إلى بثرات يتم في الجدري في اليوم الثامن من ظهور الطفح، ويتم في طفح الجديري في ساعات قليلة، وتنتقل عدوى الجديري بواسطة الرذاذ الخارج من المسالك التنفسية العليا للمرضى.`
  },

  // حشرة السمك -> أسئلة 31-35
  {
    start: 31, end: 35,
    title: "حشرة السمك",
    text: `حشرة السمك هي عبارة عن حشرة صغير، طولها يبلغ 1سم، لونها فضي، تضع بيوضها في الشقوق، وعندما تفقس تتحول صغارها إلى حورية فتكبر بسرعة وتتغذى على اللوحات والأقمشة وأغلفة الكتب والستائر والسجاد لأنها تكون متسخة. تكثر حشرة السمك في الأماكن الرطبة (المبللة) وقليلة الحركة (يقل فيها الناس) وحشرة السمك تمشي بسرعة. ولمكافحة تلك الحشرة يوجد العديد من الطرق فلابد النظافة والعناية المنزلية المستمرة أو استخدام مواد طاردة ويمكن وضع مادة قابلة للبلل.`
  },

  // العيوب -> سؤال 36 فقط
  {
    start: 36, end: 36,
    title: "العيوب",
    text: `من شغل نفسه بعيوب غيره كثرت عيوبه وهو لا يدري.`
  },

  // السمنة -> أسئلة 37-42
  {
    start: 37, end: 42,
    title: "السمنة في الدول المتقدمة",
    text: `تعرف السمنة بأنها حالة طبية تتراكم فيها دهون الجسم الزائدة لدرجة أنها تؤثر على الجسم بشكل سلبي، وتؤدي لانخفاض متوسط عمر الفرد، وسببت هذه المشكلة آثاراً سيئة في عدد من الدول، ومنها الولايات المتحدة الأمريكية حيث أن أكثر من ثلث سكانها مصابون بالسمنة، و25% من سكان كندا مصابون بالسمنة أيضاً، وعدد كبير من الشباب يصاب بها، ومن أبرز أسباب الإصابة بها الجلوس الطويل أمام التلفاز والحاسوب، ويصاب الفرد بالسمنة بسبب أن الطاقة التي يأخذها من الطعام أكبر من قدر الطاقة التي يستهلكها، وأغلب من أصيب بالسمنة من الشباب سيظل مصاباً بها حتى في سن متقدم.`
  },

  // الفلاح -> أسئلة 43-45
  {
    start: 43, end: 45,
    title: "قصة الفلاح",
    text: `سأل أحدهم فلاحاً فقال له : أزرعت قمحاً هذه السنة؟ قال الفلاح : لا، فقد خفت أن يأتي المطر ويفسده. فسأله الرجل : إذا زرعت ذرة؟ قال الفلاح : لا فقد خفت أن يأكلها النمل. قال الرجل : ما الذي زرعته إذا؟ قال الفلاح : لم أزرع شيئاً، وهكذا أنا في الجانب الآمن.`
  },

  // الشجاعة -> أسئلة 46-50
  {
    start: 46, end: 50,
    title: "الشجاعة",
    text: `كم من شجاع غلب الناس بشجاعته وهزمهم بإقدامه!`
  },

  // الأحذية -> أسئلة 51-53
  {
    start: 51, end: 53,
    title: "الأحذية",
    text: `كان المصريون أول شعب متحضر يصنع الأحذية... (النص يذكر استخدام لبادات الجلود والبردى، تطور الرومان، وصنع الأحذية الخشبية التي كانت ثقيلة وتسبب الانزلاق، ثم البريطانيون صنعوا أحذية المطاط).`
  },

  // النمو والتنمية -> أسئلة 54-57
  {
    start: 54, end: 57,
    title: "النمو والتنمية",
    text: `كلمتا النمو والتنمية كلمتان مترابطتان... (تتحدث الفقرة عن مفهوم النمو كمظهر مادي، والتنمية كتطور نوعي وإجراءات لتحسين الظروف وتلبية الاحتياجات العامة).`
  },

  // الزيت -> أسئلة 58-62
  {
    start: 58, end: 62,
    title: "الزيت",
    text: `عرف الإنسان الزيت من قديم الزمان واستعمله في احتياجاته كالبناء والطلاء، وتعبيد الطرق، ومداواة الجروح... ومع الزمن اتسعت صناعة البترول ومنتجاته الكيميائية، فأصبح يصنع منها الآن عدد لا يحصى من المواد.`
  }
];

// ---------- دوال مساعدة لصياغة النص وعرض الدرجة ----------
function el(id) {
  return document.getElementById(id);
}

/**
 * findParagraphForQuestion(qId)
 * - يرجع كائن الفقرة (title, text) أو null إذا لا توجد فقرة للسؤال.
 */
function findParagraphForQuestion(qId) {
  for (const p of questionParagraphs) {
    if (qId >= p.start && qId <= p.end) return p;
  }
  return null;
}

/**
 * findQuestionById(qId)
 * - يجد السؤال الأصلي من القائمة الكلية.
 */
function findQuestionById(qId) {
    return rawQuestionsData.find(q => q.id === qId);
}

/**
 * normalizeText(raw)
 * - يصحح عرض الرموز الرياضية والدرجات.
 */
function normalizeText(raw) {
  if (!raw && raw !== "") return "";
  let t = String(raw);
  // استبدال رموز LaTeX الشائعة غير المعالجة بـ HTML
  t = t.replace(/\^\{\\circ\}/g, "°");
  t = t.replace(/\\circ/g, "°");
  t = t.replace(/\$/g, ""); // إزالة علامات $
  return t;
}

// ---------- تهيئة الأسئلة (load based on mode) ----------
let questions = [];

// تصفية القائمة الأصلية لحذف السؤال رقم 90
const filteredQuestions = rawQuestionsData.filter(q => q.id !== 90);

let savedQuestions = localStorage.getItem("questions");
if (savedQuestions) {
  questions = JSON.parse(savedQuestions);
  const savedTime = parseInt(localStorage.getItem("timeLeft") || DEFAULT_TIME_SECONDS);
  timeLeft = savedTime;
} else {
  if (mode === "quick") {
    // المحاكي السريع: أول 24 سؤالاً من القائمة المفلترة
    questions = filteredQuestions.slice(0, 24).map(q => ({
      ...q,
      answer: null,
      marked: false,
    }));
  } else if (mode === "real") {
    // المحاكي الواقعي: تقسيم الأسئلة المفلترة على 5 أقسام
    const questionsPerSection = Math.floor(filteredQuestions.length / totalSections); // 119/5 = 23 سؤال + 4 أسئلة (24 * 4 + 23)
    const startIndex = (section - 1) * questionsPerSection;
    let endIndex = startIndex + questionsPerSection;
    
    // لضمان أن القسم الأخير يأخذ ما تبقى
    if (section === totalSections) {
        endIndex = filteredQuestions.length;
    }
    
    questions = filteredQuestions.slice(startIndex, endIndex).map(q => ({
      ...q,
      answer: null,
      marked: false,
    }));
  } else {
    // الحالة الافتراضية
    questions = filteredQuestions.slice(0, 5).map(q => ({
      ...q,
      answer: null,
      marked: false,
    }));
  }
}


// ---------- دالة عرض / تحديث السؤال ----------
function updateQuestion() {
  const q = questions[currentIndex];

  // عرض عنوان القسم/السؤال
  const sectionTitleEl = el("section-title");
  if (sectionTitleEl) {
    sectionTitleEl.textContent = (mode === 'real') ?
      `القسم ${section} - السؤال ${currentIndex + 1} / ${questions.length}` :
      `السؤال ${currentIndex + 1} / ${questions.length}`;
  }

  // ---------- عرض الفقرة الرمادية (إن وُجدت) ----------
  const passageContainer = el("passage-container");
  const paragraph = findParagraphForQuestion(q.id);

  if (passageContainer) {
    if (paragraph) {
      // نعرض الفقرة دائماً مع كل سؤال من مجموعة الفقرة (كما طلبت)
      passageContainer.innerHTML = `
                <div class="passage-box" role="region" aria-label="فقرة الاستيعاب">
          <h3 id="passage-header" class="passage-title" style="color: #0077b6; margin-top: 0;">${escapeHtml(paragraph.title)}</h3>
          <p id="passage-text" class="passage-text" style="white-space: pre-wrap; direction: rtl; text-align: justify;">${escapeHtml(paragraph.text)}</p>
        </div>
      `;
      passageContainer.style.display = "block";
    } else {
      passageContainer.innerHTML = "";
      passageContainer.style.display = "none";
    }
  }

  // ---------- عرض نص السؤال ----------
  const questionTextEl = el("question-text");
  if (questionTextEl) {
    questionTextEl.innerHTML = normalizeText(q.text);
  }

  // ---------- عرض الخيارات (radiobuttons) ----------
  const answersEl = el("answers");
  if (answersEl) {
    let answersHTML = "";
    q.options.forEach((opt, i) => {
      // استخدم normalizeText لعرض رمز الدرجة وازالة $ حول المعادلات البسيطة
      const optHtml = normalizeText(opt);
      const checked = (q.answer !== null && q.answer === i) ? "checked" : "";
      answersHTML += `
        <label class="answer-label">
          <input type="radio" name="answer" value="${i}" ${checked}>
          <span class="answer-text">${optHtml}</span>
        </label>
      `;
    });
    answersEl.innerHTML = answersHTML;
  }

  // ---------- منطق أزرار تسليم القسم / إنهاء الامتحان ----------
  const endExamBtn = el("end-exam");
  const submitSectionBtn = el("submit-section-btn"); 

  const isLastQuestion = currentIndex === questions.length - 1;
  const isRealMode = mode === 'real';
  const isLastSection = section === totalSections;

  if (isLastQuestion) {
    if (isRealMode && !isLastSection) {
      if (submitSectionBtn) submitSectionBtn.style.display = "inline-block";
      if (endExamBtn) endExamBtn.style.display = "none";
    } else {
      if (endExamBtn) endExamBtn.style.display = "inline-block";
      if (submitSectionBtn) submitSectionBtn.style.display = "none";
    }
  } else {
    // ليس السؤال الأخير: أخفِ كلا الزرين
    if (endExamBtn) endExamBtn.style.display = "none";
    if (submitSectionBtn) submitSectionBtn.style.display = "none";
  }
}

// ---------- دوال حفظ الإجابات / الانتقال ----------
function saveAnswer() {
  const selected = document.querySelector("input[name='answer']:checked");
  questions[currentIndex].answer = selected ? parseInt(selected.value) : null;

  // حفظ التقدّم في localStorage
  localStorage.setItem("questions", JSON.stringify(questions));
  localStorage.setItem("timeLeft", timeLeft);
  // قسم (section) موجود مسبقاً في localStorage إن الوضع real
  if (mode === "real") {
    localStorage.setItem("section", section);
  }
}

function nextQuestion() {
  saveAnswer();
  if (currentIndex < questions.length - 1) {
    currentIndex++;
    updateQuestion();
  }
}

function prevQuestion() {
  saveAnswer();
  if (currentIndex > 0) {
    currentIndex--;
    updateQuestion();
  }
}

function markQuestion() {
  questions[currentIndex].marked = true;
  saveAnswer();
  alert("⭐ تم وضع علامة مرجعية");
}

// ---------- صفحة المراجعة الجزئية للقسم ----------
function reviewSection() {
  saveAnswer();

  // نعرض واجهة مبسطة لمراجعة القسم
  let html = `<div style="padding:20px; font-family: sans-serif;">
    <h2>مراجعة القسم ${section}</h2>
    <ul style="list-style: none; padding: 0;">`;

  questions.forEach((q, i) => {
    let status = q.answer !== null ? "✅ مجاب" : "❌ غير مجاب";
    if (q.marked) status += " ⭐ مرجعي";
    html += `<li style="margin-bottom:8px;">سؤال ${i + 1}: ${status} <button onclick="goTo(${i})">🔁 انتقل</button></li>`;
  });

  html += `</ul>
    <div style="margin-top:12px;">
      <button onclick="goTo(0)">🔙 العودة لأول سؤال</button>
      <button onclick="chooseQuestion()">🔍 الذهاب لسؤال محدد</button>
      <button onclick="endSection()">✅ إنهاء القسم</button>
    </div>
  </div>`;

  // استبدال جسم الصفحة ببساطة واجهة المراجعة
  document.body.innerHTML = html;
}

function goTo(index) {
  saveAnswer();
  localStorage.setItem("returnTo", index);
  location.reload();
}

function chooseQuestion() {
  const num = prompt("أدخل رقم السؤال:");
  if (num && !isNaN(num) && num >= 1 && num <= questions.length) {
    goTo(parseInt(num) - 1);
  }
}

// ---------- إنهاء القسم (تسليم) ----------
function endSection() {
  saveAnswer();

  if (mode === "real" && section < totalSections) {
    if (!confirm(`هل أنت متأكد من تسليم القسم ${section} والانتقال للقسم ${section + 1}؟ لن تتمكن من العودة لهذا القسم.`)) {
      return;
    }

    // الترقية للقسم التالي
    localStorage.setItem("section", section + 1);
    // مسح أسئلة هذا القسم ووقت هذا القسم حتى يُحمّل القسم الجديد
    localStorage.removeItem("questions");
    localStorage.removeItem("timeLeft");
    location.reload();
  } else {
    // استدعاء إنهاء الامتحان النهائي
    finishExam();
  }
}

// ---------- إنهاء الامتحان: حساب الدرجات + تخزين النتائج ----------
function finishExam() {
  saveAnswer();
  
  // 1. حساب الدرجات وتجميع الأخطاء
  let score = 0;
  let correctCount = 0;
  let incorrectCount = 0;
  let unattemptedCount = 0;
  let reviewQuestions = [];
  
  // نجمع الأسئلة من كل الأقسام السابقة أيضًا إذا كان الاختبار واقعيًا (افتراضيًا نركز على القسم الحالي)
  
  questions.forEach(q => {
    if (q.answer !== null) {
      if (q.answer === q.correct) {
        correctCount++;
        score += q.value || 0; 
      } else {
        incorrectCount++;
        reviewQuestions.push(q);
      }
    } else {
      unattemptedCount++;
      reviewQuestions.push(q);
    }
  });

  // 2. تخزين النتائج النهائية وقائمة المراجعة
  localStorage.setItem("finalScore", score.toFixed(2));
  localStorage.setItem("correctCount", correctCount);
  localStorage.setItem("incorrectCount", incorrectCount);
  localStorage.setItem("unattemptedCount", unattemptedCount);
  localStorage.setItem("reviewQuestions", JSON.stringify(reviewQuestions));
  
  // تنظيف بيانات الجلسة
  localStorage.removeItem("questions");
  localStorage.removeItem("timeLeft");
  
  // 3. الانتقال لصفحة المراجعة (review.html)
  window.location.href = "review.html";
}

// ---------- عداد الوقت (Timer) ----------
function formatTime(seconds) {
  const min = Math.floor(seconds / 60);
  const sec = seconds % 60;
  return `${min}:${sec < 10 ? "0" + sec : sec}`;
}

setInterval(() => {
  if (timeLeft > 0) {
    timeLeft--;
    // حفظ الوقت المتبقي في كل ثانية لضمان استمرارية البيانات
    localStorage.setItem("timeLeft", timeLeft);
    const timerEl = el("timer");
    if (timerEl) timerEl.textContent = `الوقت المتبقي: ${formatTime(timeLeft)}`;
  } else {
    // مراجعة القسم التلقائية عند انتهاء الوقت
    reviewSection();
  }
}, 1000);

// ---------- التعامل مع العودة إلى سؤال محدد (returnTo) ----------
const returnTo = localStorage.getItem("returnTo");
if (returnTo !== null) {
  currentIndex = parseInt(returnTo);
  localStorage.removeItem("returnTo");
}

// ---------- دوال مساعدة آمنة (للحماية من HTML) ----------
function escapeHtml(unsafe) {
  if (unsafe === null || unsafe === undefined) return "";
  return String(unsafe)
    .replace(/&/g, "&amp;")
    .replace(/</g, "&lt;")
    .replace(/>/g, "&gt;")
    .replace(/"/g, "&quot;")
    .replace(/'/g, "&#039;");
}

// ---------- تحميل أول سؤال وتحديث الواجهة ----------
updateQuestion();
